import{r as m,p as r,t as l,Q as ml,P as q,S as n,U as d,O as p,ai as E,V as H,aD as I,F,aa as A,T as e,M as T,aB as fl,q as i,I as M,J as O}from"./vue-CQnFr7Mm.js";import{_ as xl,u as gl,a as yl,l as hl,e as bl,b as _l}from"./index-DvaJYu1w.js";import{l as U}from"./lodash-CNPm4k7W.js";import{c as kl}from"./changeModel-DHxmR1HF.js";import{C as Vl}from"./echart-FMvX9Foq.js";import"./element-DYg7Q49L.js";import"./fselect-B0rI_y1k.js";const wl={class:"page-index c-text-left"},zl={class:"module-header"},Cl={class:"model"},Fl={class:"c-cardbox"},Al={class:"lbox"},Tl={class:"rbox"},$l={key:0,class:"c-cardtitlebox c-rowbox"},El={style:{"min-height":"60px"},class:"contentbox"},Ml={class:"params-grid"},Ul={class:"param-group"},Dl={class:"param-group"},Sl={class:"param-group"},Ll={class:"c-rowbox"},Bl={class:"c-cardtitlebox"},Nl={class:"titlebox"},Wl={style:{"min-height":"150px"},class:"contentbox"},jl={class:"c-rowbox"},ql={class:"c-cardtitlebox"},Hl={class:"titlebox"},Il={style:{"min-height":"150px"},class:"contentbox"},Ol={class:"c-cardtitlebox c-rowbox"},Pl={class:"contentbox"},Jl={class:"c-gred"},Ql={class:"c-cardtitlebox"},Rl={style:{"min-height":"160px"},class:"contentbox"},Gl={key:0,class:"lbox-content outputcontent"},Kl=["innerHTML"],Xl={key:1,class:"empty-state"},Yl={class:"c-cardtitlebox"},Zl={style:{"min-height":"160px"},class:"contentbox"},lt={key:0,class:"lbox-content outputcontent"},tt=["innerHTML"],st={key:1,class:"empty-state"},at={style:{"margin-top":"1.5rem"},class:"c-gred"},et={class:"c-cardtitlebox"},ot={class:"titlebox nobg"},nt={style:{"min-height":"160px"},class:"contentbox"},it={key:0,class:"outcontain"},ut={class:"lbox-content outputbox"},rt=["title","onClick"],dt={key:1,class:"empty-state"},vt={class:"c-cardtitlebox"},pt={style:{"min-height":"160px"},class:"contentbox"},ct={key:0,class:"outcontain"},mt={class:"lbox-content outputbox"},ft=["title","onClick"],xt={key:1,class:"empty-state"},gt={class:"c-cardtitlebox c-rowbox"},yt={class:"contentbox"},ht={class:"c-gred"},bt={class:"c-cardtitlebox"},_t={class:"titlebox nobg"},kt={style:{"min-height":"500px"},class:"contentbox js-curechartbox"},Vt={key:0,class:"chart-container loss-chart"},wt={class:"chart-header"},zt={class:"chart-summary"},Ct={class:"chart-range-selector"},Ft={class:"range-inputs"},At={class:"chart-content"},Tt={class:"chart-token"},$t={class:"chart-value"},Et={key:1,class:"empty-state"},Mt={class:"c-cardtitlebox"},Ut={style:{"min-height":"500px"},class:"contentbox js-curechartbox"},Dt={key:0,class:"chart-container loss-chart"},St={class:"chart-header"},Lt={class:"chart-summary"},Bt={class:"chart-range-selector"},Nt={class:"range-inputs"},Wt={class:"chart-content"},jt={class:"chart-token"},qt={class:"chart-value"},Ht={key:1,class:"empty-state"},It={class:"c-cardtitlebox c-rowbox"},Ot={class:"contentbox"},Pt={class:"c-gred"},Jt={class:"c-cardtitlebox"},Qt={class:"titlebox nobg"},Rt={style:{"min-height":"500px"},class:"contentbox js-curechartbox"},Gt={key:0,class:"chart-container loss-chart"},Kt={class:"chart-header"},Xt={class:"chart-summary"},Yt={class:"chart-range-selector"},Zt={class:"range-inputs"},ls={class:"chart-content"},ts={class:"chart-token"},ss={class:"chart-value"},as={key:1,class:"empty-state"},es={class:"c-cardtitlebox"},os={style:{"min-height":"500px"},class:"contentbox js-curechartbox"},ns={key:0,class:"chart-container loss-chart"},is={class:"chart-header"},us={class:"chart-summary"},rs={class:"chart-range-selector"},ds={class:"range-inputs"},vs={class:"chart-content"},ps={class:"chart-token"},cs={class:"chart-value"},ms={key:1,class:"empty-state"},fs={class:"c-cardtitlebox c-rowbox"},xs={style:{"min-height":"640px"},class:"contentbox"},gs={key:1,class:"empty-state"},ys={__name:"index",setup(hs){gl(),fl();const h=m({input:"",output:""}),b=m(null),S=m(null),P=m(null),y=m("1"),_=m(null),k=m(null),V=m(null),w=m(null),ll=async()=>{if(h.value.input==="")return _this.$message("请输入数据","error");y.value=="1"?tl():y.value=="2"?sl():y.value=="3"?al():y.value=="4"&&pl()},tl=async()=>{h.value.model_name=D.value||void 0;const a=await yl(h.value);a&&a.data&&(b.value=a.data),$("input"),$("output")},sl=async()=>{h.value.model_name=D.value||void 0;const a=await hl(h.value);a&&a.data&&(S.value=a.data),L("input",S.value),L("output",S.value)},al=async()=>{h.value.model_name=D.value||void 0;const a=await bl(h.value);a&&a.data&&(P.value=a.data),L("input",P.value),L("output",P.value)},el=(a,t)=>{let o=[],v=U.cloneDeep(a),g=t;return v.forEach(f=>{f&&f.indexOf(`
`)>-1?o.push(f.replace(/\n/g,g)):o.push(f)}),o};m(null),m(null);const L=(a,t)=>{let o=a==="input"?U.cloneDeep(t.origin_output_tokens):U.cloneDeep(t.output_tokens),v=a==="input"?U.cloneDeep(t.origin_loss_per_token):U.cloneDeep(t.loss_per_token);o=el(o,"\\n");let g=Math.max(...v),f=Math.min(...v),x=v.reduce((s,u)=>s+u,0)/v.length,c=[];return o.forEach((s,u)=>{c.push({text:s&&s.replace(/\n/g,"\\n"),value:v[u],maxVal:g,minVal:f,bar:v[u]/g*100})}),y.value==="2"?a==="input"?_.value={list:c,maxVal:g.toFixed(3),maxAllVal:g.toFixed(3)+.001,minAllVal:f.toFixed(3),minVal:f.toFixed(3),min:0,max:g.toFixed(3),average:x}:k.value={list:c,maxAllVal:g.toFixed(3)+.001,minAllVal:f.toFixed(3),maxVal:g.toFixed(3),minVal:f.toFixed(3),min:0,max:g.toFixed(3),average:x}:y.value==="3"&&(a==="input"?V.value={list:c,maxAllVal:g.toFixed(3)+.001,minAllVal:f.toFixed(3),maxVal:g.toFixed(3),minVal:f.toFixed(3),min:0,max:g.toFixed(3),average:x}:w.value={list:c,maxAllVal:g.toFixed(3)+.001,minAllVal:f.toFixed(3),maxVal:g.toFixed(3),minVal:f.toFixed(3),min:0,max:g.toFixed(3),average:x}),c},C=a=>{if(!a)return[];let t=U.cloneDeep(a.list),o=t.filter(c=>c.value>=a.min&&c.value<=a.max),v=[];o.forEach(c=>{v.push(c.value)});let g=Math.max(...v),f=Math.min(...v),x=v.reduce((c,s)=>c+s,0)/v.length;return a.average=x.toFixed(3),a.minVal=f.toFixed(3),a.maxVal=g.toFixed(3),console.log("filters",a),t.filter(c=>c.value>=a.min&&c.value<=a.max)},J=m([]),Q=m([]),R=m(1),G=m(1),$=(a,t)=>{console.log(a,t);let o=[];nl.value="",il.value="";let v="";if(a==="input"){B.value=t,t!==void 0?(v=b.value.origin_output_tokens[B.value],o=b.value.origin_attention_scores[t]):(v="",b.value.origin_attention_scores.forEach((x,c)=>{x.forEach((s,u)=>{o[u]||(o[u]=0),o[u]+=s})})),R.value=Math.max(...o);let g=Math.min(...o),f=[];b.value.input_tokens.forEach((x,c)=>{f.push({text:x&&x.replace(/\n/g,"\\n"),value:o[c],maxVal:R.value,answer:v,minVal:g,color:Y(o[c],R.value)})}),J.value=f}else{N.value=t,t!==void 0?(v=b.value.output_tokens[N.value],o=b.value.attention_scores[t]):(v="",b.value.attention_scores.forEach((x,c)=>{x.forEach((s,u)=>{o[u]||(o[u]=0),o[u]+=s})})),G.value=Math.max(...o);let g=Math.min(...o),f=[];b.value.input_tokens.forEach((x,c)=>{f.push({text:x&&x.replace(/\n/g,"\\n"),value:o[c],maxVal:G.value,minVal:g,answer:v,color:Y(o[c],G.value)})}),Q.value=f}},Y=(a,t)=>`rgba(2, 169, 169,${a/t})`,B=m(void 0),N=m(void 0),ol=()=>{h.value.input="",h.value.output="",y.value==="4"&&(z.value={is_grenerate_output:!1,input:"",output:"",smooth_window:5,z_score_threshold:.5})},nl=m(""),il=m(""),D=m("./big-models/"),ul=m(!1),rl=a=>{D.value=a.val,ul.value=!1},dl=m('大语言模型是一种人工智能系统，它通过学习大量的文本数据来理解和生成人类语言。想象一下，它就像是一个"超级记事本"，记住了互联网上的大量文章、书籍和对话。'),vl=m(`请解释一下什么是大语言模型，以及它们是如何工作的？
请用通俗易懂的语言回答，适合非技术人员理解。`),K=a=>{a&&window._this.$copy(a)},Z=a=>`${a.length>0?a.reduce((o,v)=>o+v,0)/a.length:0}`,z=m({is_grenerate_output:!1,input:"",output:"",smooth_window:5,z_score_threshold:.5}),W=m(null),X=m(null),pl=async()=>{if(z.value.input=h.value.input,z.value.output=h.value.output,!z.value.is_grenerate_output&&!z.value.output)return window._this.$message("请输入问题和期望答案后再进行操作","error");_l(z.value).then(a=>{a&&a.code===200&&(h.value.input=a.data.input,h.value.output=a.data.output,z.value.input=a.data.input,z.value.output=a.data.output,W.value=a.data.result,X.value&&X.value.init(W.value))})},j=(a,t)=>a&&a.toFixed?a.toFixed(t):a;return(a,t)=>{const o=E("el-button"),v=E("el-input-number"),g=E("el-switch"),f=E("el-input"),x=E("el-popover"),c=E("el-scrollbar");return i(),r("div",wl,[l("div",zl,[t[30]||(t[30]=l("h1",{class:"module-title"},[l("i",{class:"fas fa-brain"}),n(" 注意力分析 ")],-1)),l("div",Cl,[d(kl,{val:D.value,onSubfn:rl},null,8,["val"])])]),l("div",Fl,[l("div",Al,[d(o,{size:"large",onClick:t[0]||(t[0]=s=>y.value="1"),type:y.value=="1"?"primary":"info"},{default:p(()=>t[31]||(t[31]=[l("i",{class:"fas fa-chart-bar"},null,-1),n(" 注意力分数分析")])),_:1},8,["type"]),d(o,{size:"large",onClick:t[1]||(t[1]=s=>y.value="2"),type:y.value=="2"?"primary":"info"},{default:p(()=>t[32]||(t[32]=[l("i",{class:"fas fa-chart-line"},null,-1),n(" Token损失分析")])),_:1},8,["type"]),d(o,{size:"large",onClick:t[2]||(t[2]=s=>y.value="3"),type:y.value=="3"?"primary":"info"},{default:p(()=>t[33]||(t[33]=[l("i",{class:"fas fa-random"},null,-1),n(" Token熵分析")])),_:1},8,["type"]),d(o,{size:"large",onClick:t[3]||(t[3]=s=>y.value="4"),type:y.value=="4"?"primary":"info"},{default:p(()=>t[34]||(t[34]=[l("i",{class:"fas fa-text-width"},null,-1),n(" Token异常分析")])),_:1},8,["type"])]),l("div",Tl,[d(o,{onClick:ol,tabindex:"-1",type:"info"},{default:p(()=>t[35]||(t[35]=[l("i",{class:"fas fa-redo"},null,-1),n(" 重置")])),_:1}),d(o,{onClick:ll,tabindex:"-1",type:"primary"},{default:p(()=>t[36]||(t[36]=[l("i",{class:"fas fa-play"},null,-1),n(" 生成分析")])),_:1})])]),y.value==4?(i(),r("div",$l,[l("div",El,[l("div",Ml,[l("div",Ul,[t[37]||(t[37]=l("label",{class:"param-label"}," token窗口大小 ",-1)),d(v,{"controls-position":"right",step:1,min:1,onFocus:t[4]||(t[4]=s=>s.target.select()),style:{width:"100%"},modelValue:z.value.smooth_window,"onUpdate:modelValue":t[5]||(t[5]=s=>z.value.smooth_window=s),placeholder:""},null,8,["modelValue"])]),l("div",Dl,[t[38]||(t[38]=l("label",{class:"param-label"}," 判定异常阈值(熵和损失的背离阈值) ",-1)),d(v,{controls:!1,onFocus:t[6]||(t[6]=s=>s.target.select()),style:{width:"100%"},modelValue:z.value.z_score_threshold,"onUpdate:modelValue":t[7]||(t[7]=s=>z.value.z_score_threshold=s),placeholder:""},null,8,["modelValue"])]),l("div",Sl,[t[39]||(t[39]=l("label",{class:"param-label"},"模型生成输出",-1)),d(g,{modelValue:z.value.is_grenerate_output,"onUpdate:modelValue":t[8]||(t[8]=s=>z.value.is_grenerate_output=s)},null,8,["modelValue"])])])])])):ml("",!0),l("div",Ll,[l("div",Bl,[l("div",Nl,[t[41]||(t[41]=l("span",null,[l("i",{class:"fas fa-question-circle"}),n("输入内容 "),l("span",{style:{display:"inline",top:"0"},class:"c-tips"},[l("span",{class:"c-danger"},"*"),n("(必填)此处输入模型的input，模型会自动输出output，可以计算自身output对input的分数")])],-1)),d(o,{onClick:t[9]||(t[9]=s=>h.value.input=vl.value),size:"small",type:"info"},{default:p(()=>t[40]||(t[40]=[l("i",{class:"fas fa-file-import"},null,-1),n(" 示例")])),_:1})]),l("div",Wl,[d(f,{modelValue:h.value.input,"onUpdate:modelValue":t[10]||(t[10]=s=>h.value.input=s),style:{width:"100%"},rows:7,type:"textarea",placeholder:""},null,8,["modelValue"])])])]),l("div",jl,[l("div",ql,[l("div",Hl,[t[43]||(t[43]=l("span",null,[l("i",{class:"fas fa-bullseye"}),n(" 目标输出 "),l("span",{style:{display:"inline",top:"0"},class:"c-tips"}," (选填)此处人工指定的output，可以计算指定output对input的注意力分数")],-1)),d(o,{onClick:t[11]||(t[11]=s=>h.value.output=dl.value),size:"small",type:"info"},{default:p(()=>t[42]||(t[42]=[l("i",{class:"fas fa-file-import"},null,-1),n(" 示例")])),_:1})]),l("div",Il,[d(f,{disabled:z.value.is_grenerate_output&&y.value==4,modelValue:h.value.output,"onUpdate:modelValue":t[12]||(t[12]=s=>h.value.output=s),style:{width:"100%"},rows:7,type:"textarea",placeholder:""},null,8,["disabled","modelValue"])])])]),q(l("div",Ol,[t[52]||(t[52]=I('<div class="titlebox" data-v-343128ad><div class="tl" data-v-343128ad>注意力分数对比分析 <div style="font-size:0.75rem;color:#6b7280;margin-top:0.5rem;font-weight:normal;" data-v-343128ad><i class="fas fa-info-circle" data-v-343128ad></i><strong style="font-weight:bold;" data-v-343128ad>使用步骤：</strong>1️⃣ 先点击左右两侧答案中的token（或All按钮）查看注意力高亮；2️⃣ 再点击对应下方高亮的问题token查看详细分数。<br data-v-343128ad><small style="color:#6b7280;margin-top:4px;display:block;" data-v-343128ad><i class="fas fa-lightbulb" data-v-343128ad></i> 提示：左右两侧独立操作，互不影响。分数显示在对应区域下方。</small></div></div></div>',1)),l("div",Pl,[l("div",Jl,[l("div",Ql,[t[45]||(t[45]=l("div",{class:"titlebox nobg"},[l("span",null,[l("i",{class:"fas fa-robot"}),n("原始问题/提示 - 注意力高亮 "),l("span",{style:{top:"0",display:"inline"},class:"c-tips"},"(模型自动生成的output)")])],-1)),l("div",Rl,[J.value.length>0?(i(),r("div",Gl,[(i(!0),r(F,null,A(J.value,(s,u)=>(i(),T(x,{key:u,"show-after":500,placement:"top","popper-style":{width:"auto",padding:"10px",minWidth:"80px"},trigger:"hover"},{reference:p(()=>[(i(),r("span",{class:"item",style:M("background-color:"+s.color),key:u,innerHTML:s.text},null,12,Kl))]),default:p(()=>[l("div",null,e(s.value)+" "+e(s.answer?"|对应模型自动生成的output的token: "+s.answer:""),1)]),_:2},1024))),128))])):(i(),r("div",Xl,t[44]||(t[44]=[l("i",{class:"fas fa-question-circle"},null,-1),l("p",null,"点击下方模型答案的token查看注意力分数",-1)])))])]),l("div",Yl,[t[47]||(t[47]=l("div",{class:"titlebox nobg"},[l("span",null,[l("i",{class:"fas fa-bullseye"}),n("原始问题/提示 - 注意力高亮 "),l("span",{style:{top:"0",display:"inline"},class:"c-tips"},"(人工指定的output)")])],-1)),l("div",Zl,[Q.value.length>0?(i(),r("div",lt,[(i(!0),r(F,null,A(Q.value,(s,u)=>(i(),T(x,{key:u,"show-after":500,placement:"top","popper-style":{width:"auto",padding:"10px",minWidth:"80px"},trigger:"hover"},{reference:p(()=>[(i(),r("span",{class:"item",style:M("background-color:"+s.color),key:u,innerHTML:s.text},null,12,tt))]),default:p(()=>[l("div",null,e(s.value)+" "+e(s.answer?"| 对应人工指定的output的token: "+s.answer:""),1)]),_:2},1024))),128))])):(i(),r("div",st,t[46]||(t[46]=[l("i",{class:"fas fa-question-circle"},null,-1),l("p",null,"点击下方目标答案的token查看注意力分数",-1)])))])])]),l("div",at,[l("div",et,[l("div",ot,[t[48]||(t[48]=l("span",null,[l("i",{class:"fas fa-robot"}),l("span",null,[n("模型生成答案 "),l("span",{style:{top:"0",display:"inline"},class:"c-tips"},"(模型生成的output)")])],-1)),d(o,{size:"small",type:"info"},{default:p(()=>[l("i",{onClick:t[13]||(t[13]=s=>K(b.value.origin_output_tokens)),title:"复制完整答案",class:"fas fa-copy"})]),_:1})]),l("div",nt,[b.value&&b.value.origin_output_tokens?(i(),r("div",it,[d(c,null,{default:p(()=>[l("div",ut,[l("div",{title:"查看所有token的平均注意力分布",class:O(["item all",{on:B.value===void 0}]),onClick:t[14]||(t[14]=s=>$("input",void 0))}," All ",2),(i(!0),r(F,null,A(b.value.origin_output_tokens,(s,u)=>(i(),r("div",{class:O(["item",{on:B.value===u}]),title:Z(b.value.origin_attention_scores[u],"1"),onClick:cl=>$("input",u),key:u},e(s),11,rt))),128))])]),_:1})])):(i(),r("div",dt,t[49]||(t[49]=[l("i",{class:"fas fa-robot"},null,-1),l("p",null,"模型生成的答案将在这里显示",-1)])))])]),l("div",vt,[t[51]||(t[51]=l("div",{class:"titlebox nobg"},[l("span",null,[l("i",{class:"fas fa-bullseye"}),l("span",null,[n("目标期望答案"),l("span",{style:{top:"0",display:"inline"},class:"c-tips"},"(人工指定的output)")])])],-1)),l("div",pt,[b.value&&b.value.output_tokens?(i(),r("div",ct,[d(c,null,{default:p(()=>[l("div",mt,[l("div",{title:"查看所有token的平均注意力分布",class:O(["item all",{on:N.value===void 0}]),onClick:t[15]||(t[15]=s=>$("output",void 0))}," All ",2),(i(!0),r(F,null,A(b.value.output_tokens,(s,u)=>(i(),r("div",{class:O(["item",{on:N.value===u}]),title:Z(b.value.attention_scores[u],"2"),onClick:cl=>$("output",u),key:u},e(s),11,ft))),128))])]),_:1})])):(i(),r("div",xt,t[50]||(t[50]=[l("i",{class:"fas fa-bullseye"},null,-1),l("p",null,"目标期望答案将在这里显示",-1)])))])])])])],512),[[H,y.value=="1"]]),q(l("div",gt,[t[73]||(t[73]=I('<div class="titlebox" data-v-343128ad><div class="tl" data-v-343128ad><span style="color:rgb(220, 38, 38);" data-v-343128ad>Token损失分析对比</span><div style="font-size:0.75rem;color:#6b7280;margin-top:0.5rem;font-weight:normal;" data-v-343128ad><i class="fas fa-exclamation-triangle" style="color:#dc2626;" data-v-343128ad></i> 对比模型答案和目标答案的Token损失分布，损失值越高表示预测难度越大 </div></div></div>',1)),l("div",yt,[l("div",ht,[l("div",bt,[l("div",_t,[t[53]||(t[53]=l("span",null,[l("i",{class:"fas fa-robot"}),l("span",null,"模型生成答案")],-1)),d(o,{size:"small",type:"info"},{default:p(()=>[l("i",{onClick:t[16]||(t[16]=s=>K(b.value.origin_output_tokens)),title:"复制完整答案",class:"fas fa-copy"})]),_:1})]),l("div",kt,[_.value?(i(),r("div",Vt,[l("div",wt,[t[58]||(t[58]=l("div",{class:"chart-title"},[l("i",{class:"fas fa-chart-bar"}),n(" 损失值分析 (模型答案) ")],-1)),l("div",zt,[l("span",null,[t[54]||(t[54]=l("i",{class:"fas fa-list"},null,-1)),n(" "+e(C(_.value).length)+"个token (损失值: "+e(_.value.min)+"-"+e(_.value.max)+")",1)]),l("span",null,[t[55]||(t[55]=l("i",{class:"fas fa-arrow-up"},null,-1)),n(" 最大: "+e(_.value.maxVal),1)]),l("span",null,[t[56]||(t[56]=l("i",{class:"fas fa-arrow-down"},null,-1)),n(" 最小: "+e(_.value.minVal),1)]),l("span",null,[t[57]||(t[57]=l("i",{class:"fas fa-calculator"},null,-1)),n(" 平均: "+e(_.value.average),1)])])]),l("div",Ct,[t[61]||(t[61]=l("div",{class:"range-selector-label"},[l("i",{class:"fas fa-filter"}),n(" 损失值范围: ")],-1)),l("div",Ft,[d(v,{"controls-position":"right",style:{width:"100px"},modelValue:_.value.min,"onUpdate:modelValue":t[17]||(t[17]=s=>_.value.min=s),placeholder:"",size:"small",min:0,max:_.value.maxAllVal,step:.001},null,8,["modelValue","max"]),t[60]||(t[60]=l("span",{style:{margin:"0 10px"},class:"range-separator"},"-",-1)),d(v,{"controls-position":"right",style:{width:"100px"},modelValue:_.value.max,"onUpdate:modelValue":t[18]||(t[18]=s=>_.value.max=s),placeholder:"",size:"small",min:0,max:_.value.maxAllVal,step:.001},null,8,["modelValue","max"]),d(o,{onClick:t[19]||(t[19]=s=>{_.value.min=0,_.value.max=_.value.maxAllVal}),style:{"margin-left":"10px"},type:"info",size:"small"},{default:p(()=>t[59]||(t[59]=[l("i",{class:"fas fa-refresh"},null,-1),n(" 重置")])),_:1})])]),d(c,{"max-height":"500"},{default:p(()=>[l("div",At,[(i(!0),r(F,null,A(C(_.value),(s,u)=>(i(),T(x,{effect:"dark",key:u,"show-after":200,placement:"top","popper-style":{width:"auto",padding:"10px",minWidth:"80px"},trigger:"hover"},{reference:p(()=>[(i(),r("div",{key:u,class:"chart-item"},[l("div",Tt,e(s.text),1),l("div",{class:"chart-bar loss-very-high",style:M("width: "+s.bar+"%")},null,4),l("div",$t,e(j(s.value,6)),1)]))]),default:p(()=>[l("div",null,"Token："+e(s.text)+"（Loss："+e(s.value)+"）",1)]),_:2},1024))),128))])]),_:1})])):(i(),r("div",Et,t[62]||(t[62]=[l("i",{class:"fas fa-chart-bar"},null,-1),l("p",null,"模型答案柱状图将在这里显示",-1)])))])]),l("div",Mt,[t[72]||(t[72]=l("div",{class:"titlebox nobg"},[l("span",null,[l("i",{class:"fas fa-bullseye"}),l("span",null,"目标期望答案")])],-1)),l("div",Ut,[k.value?(i(),r("div",Dt,[l("div",St,[t[67]||(t[67]=l("div",{class:"chart-title"},[l("i",{class:"fas fa-chart-bar"}),n(" 损失值分析 (目标答案) ")],-1)),l("div",Lt,[l("span",null,[t[63]||(t[63]=l("i",{class:"fas fa-list"},null,-1)),n(" "+e(C(k.value).length)+"个token (损失值: "+e(k.value.min)+"-"+e(k.value.max)+")",1)]),l("span",null,[t[64]||(t[64]=l("i",{class:"fas fa-arrow-up"},null,-1)),n(" 最大: "+e(k.value.maxVal),1)]),l("span",null,[t[65]||(t[65]=l("i",{class:"fas fa-arrow-down"},null,-1)),n(" 最小: "+e(k.value.minVal),1)]),l("span",null,[t[66]||(t[66]=l("i",{class:"fas fa-calculator"},null,-1)),n(" 平均: "+e(k.value.average),1)])])]),l("div",Bt,[t[70]||(t[70]=l("div",{class:"range-selector-label"},[l("i",{class:"fas fa-filter"}),n(" 损失值范围: ")],-1)),l("div",Nt,[d(v,{"controls-position":"right",style:{width:"100px"},modelValue:k.value.min,"onUpdate:modelValue":t[20]||(t[20]=s=>k.value.min=s),placeholder:"",size:"small",min:0,max:k.value.maxAllVal,step:.001},null,8,["modelValue","max"]),t[69]||(t[69]=l("span",{style:{margin:"0 10px"},class:"range-separator"},"-",-1)),d(v,{"controls-position":"right",style:{width:"100px"},modelValue:k.value.max,"onUpdate:modelValue":t[21]||(t[21]=s=>k.value.max=s),placeholder:"",size:"small",min:0,max:k.value.maxAllVal,step:.001},null,8,["modelValue","max"]),d(o,{onClick:t[22]||(t[22]=s=>{k.value.min=0,k.value.max=k.value.maxAllVal}),style:{"margin-left":"10px"},type:"info",size:"small"},{default:p(()=>t[68]||(t[68]=[l("i",{class:"fas fa-refresh"},null,-1),n(" 重置")])),_:1})])]),d(c,{"max-height":"500"},{default:p(()=>[l("div",Wt,[(i(!0),r(F,null,A(C(k.value),(s,u)=>(i(),T(x,{effect:"dark",key:u,"show-after":200,placement:"top","popper-style":{width:"auto",padding:"10px",minWidth:"80px"},trigger:"hover"},{reference:p(()=>[(i(),r("div",{key:u,class:"chart-item"},[l("div",jt,e(s.text),1),l("div",{class:"chart-bar loss-very-high",style:M("width: "+s.bar+"%")},null,4),l("div",qt,e(j(s.value,6)),1)]))]),default:p(()=>[l("div",null,"Token："+e(s.text)+"（Loss："+e(s.value)+"）",1)]),_:2},1024))),128))])]),_:1})])):(i(),r("div",Ht,t[71]||(t[71]=[l("i",{class:"fas fa-chart-bar"},null,-1),l("p",null,"模型答案柱状图将在这里显示",-1)])))])])])])],512),[[H,y.value=="2"]]),q(l("div",It,[t[94]||(t[94]=I('<div class="titlebox" data-v-343128ad><div class="tl" data-v-343128ad><span style="color:rgb(37, 99, 235);" data-v-343128ad>Token熵分析对比</span><div style="font-size:0.75rem;color:#6b7280;margin-top:0.5rem;font-weight:normal;" data-v-343128ad><i class="fas fa-chart-area" style="color:#2563eb;" data-v-343128ad></i> 对比模型答案和目标答案的Token熵分布，熵值越高表示选择不确定性越大 </div></div></div>',1)),l("div",Ot,[l("div",Pt,[l("div",Jt,[l("div",Qt,[t[74]||(t[74]=l("span",null,[l("i",{class:"fas fa-robot"}),l("span",null,"模型生成答案")],-1)),d(o,{size:"small",type:"info"},{default:p(()=>[l("i",{onClick:t[23]||(t[23]=s=>K(S.value.origin_output_tokens)),title:"复制完整答案",class:"fas fa-copy"})]),_:1})]),l("div",Rt,[V.value?(i(),r("div",Gt,[l("div",Kt,[t[79]||(t[79]=l("div",{class:"chart-title"},[l("i",{class:"fas fa-chart-bar"}),n(" 熵值分析 (模型答案) ")],-1)),l("div",Xt,[l("span",null,[t[75]||(t[75]=l("i",{class:"fas fa-list"},null,-1)),n(" "+e(C(V.value).length)+"个token (损失值: "+e(V.value.min)+"-"+e(V.value.max)+")",1)]),l("span",null,[t[76]||(t[76]=l("i",{class:"fas fa-arrow-up"},null,-1)),n(" 最大: "+e(V.value.maxVal),1)]),l("span",null,[t[77]||(t[77]=l("i",{class:"fas fa-arrow-down"},null,-1)),n(" 最小: "+e(V.value.minVal),1)]),l("span",null,[t[78]||(t[78]=l("i",{class:"fas fa-calculator"},null,-1)),n(" 平均: "+e(V.value.average),1)])])]),l("div",Yt,[t[82]||(t[82]=l("div",{class:"range-selector-label"},[l("i",{class:"fas fa-filter"}),n(" 熵值范围: ")],-1)),l("div",Zt,[d(v,{"controls-position":"right",style:{width:"100px"},modelValue:V.value.min,"onUpdate:modelValue":t[24]||(t[24]=s=>V.value.min=s),placeholder:"",size:"small",min:0,max:V.value.maxAllVal,step:.001},null,8,["modelValue","max"]),t[81]||(t[81]=l("span",{style:{margin:"0 10px"},class:"range-separator"},"-",-1)),d(v,{"controls-position":"right",style:{width:"100px"},modelValue:V.value.max,"onUpdate:modelValue":t[25]||(t[25]=s=>V.value.max=s),placeholder:"",size:"small",min:0,max:V.value.maxAllVal,step:.001},null,8,["modelValue","max"]),d(o,{onClick:t[26]||(t[26]=s=>{V.value.min=0,V.value.max=V.value.maxAllVal}),style:{"margin-left":"10px"},type:"info",size:"small"},{default:p(()=>t[80]||(t[80]=[l("i",{class:"fas fa-refresh"},null,-1),n(" 重置")])),_:1})])]),d(c,{"max-height":"500"},{default:p(()=>[l("div",ls,[(i(!0),r(F,null,A(C(V.value),(s,u)=>(i(),T(x,{effect:"dark",key:u,"show-after":200,placement:"top","popper-style":{width:"auto",padding:"10px",minWidth:"80px"},trigger:"hover"},{reference:p(()=>[(i(),r("div",{key:u,class:"chart-item"},[l("div",ts,e(s.text),1),l("div",{class:"chart-bar loss-very-high",style:M("width: "+s.bar+"%")},null,4),l("div",ss,e(j(s.value,6)),1)]))]),default:p(()=>[l("div",null,"Token："+e(s.text)+"（熵值："+e(s.value)+"）",1)]),_:2},1024))),128))])]),_:1})])):(i(),r("div",as,t[83]||(t[83]=[l("i",{class:"fas fa-chart-bar"},null,-1),l("p",null,"模型答案柱状图将在这里显示",-1)])))])]),l("div",es,[t[93]||(t[93]=l("div",{class:"titlebox nobg"},[l("span",null,[l("i",{class:"fas fa-bullseye"}),l("span",null,"目标期望答案")])],-1)),l("div",os,[w.value?(i(),r("div",ns,[l("div",is,[t[88]||(t[88]=l("div",{class:"chart-title"},[l("i",{class:"fas fa-chart-bar"}),n(" 熵值分析 (目标答案) ")],-1)),l("div",us,[l("span",null,[t[84]||(t[84]=l("i",{class:"fas fa-list"},null,-1)),n(" "+e(C(w.value).length)+"个token (损失值: "+e(w.value.min)+"-"+e(w.value.max)+")",1)]),l("span",null,[t[85]||(t[85]=l("i",{class:"fas fa-arrow-up"},null,-1)),n(" 最大: "+e(w.value.maxVal),1)]),l("span",null,[t[86]||(t[86]=l("i",{class:"fas fa-arrow-down"},null,-1)),n(" 最小: "+e(w.value.minVal),1)]),l("span",null,[t[87]||(t[87]=l("i",{class:"fas fa-calculator"},null,-1)),n(" 平均: "+e(w.value.average),1)])])]),l("div",rs,[t[91]||(t[91]=l("div",{class:"range-selector-label"},[l("i",{class:"fas fa-filter"}),n(" 熵值范围: ")],-1)),l("div",ds,[d(v,{"controls-position":"right",style:{width:"100px"},modelValue:w.value.min,"onUpdate:modelValue":t[27]||(t[27]=s=>w.value.min=s),placeholder:"",size:"small",min:0,max:w.value.maxAllVal,step:.001},null,8,["modelValue","max"]),t[90]||(t[90]=l("span",{style:{margin:"0 10px"},class:"range-separator"},"-",-1)),d(v,{"controls-position":"right",style:{width:"100px"},modelValue:w.value.max,"onUpdate:modelValue":t[28]||(t[28]=s=>w.value.max=s),placeholder:"",size:"small",min:0,max:w.value.maxAllVal,step:.001},null,8,["modelValue","max"]),d(o,{onClick:t[29]||(t[29]=s=>{w.value.min=0,w.value.max=w.value.maxAllVal}),style:{"margin-left":"10px"},type:"info",size:"small"},{default:p(()=>t[89]||(t[89]=[l("i",{class:"fas fa-refresh"},null,-1),n(" 重置")])),_:1})])]),d(c,{"max-height":"500"},{default:p(()=>[l("div",vs,[(i(!0),r(F,null,A(C(w.value),(s,u)=>(i(),T(x,{effect:"dark",key:u,"show-after":200,placement:"top","popper-style":{width:"auto",padding:"10px",minWidth:"80px"},trigger:"hover"},{reference:p(()=>[(i(),r("div",{key:u,class:"chart-item"},[l("div",ps,e(s.text),1),l("div",{class:"chart-bar loss-very-high",style:M("width: "+s.bar+"%")},null,4),l("div",cs,e(j(s.value,6)),1)]))]),default:p(()=>[l("div",null,"Token："+e(s.text)+"（熵值："+e(s.value)+"）",1)]),_:2},1024))),128))])]),_:1})])):(i(),r("div",ms,t[92]||(t[92]=[l("i",{class:"fas fa-chart-bar"},null,-1),l("p",null,"模型答案柱状图将在这里显示",-1)])))])])])])],512),[[H,y.value=="3"]]),q(l("div",fs,[t[96]||(t[96]=I('<div class="titlebox" data-v-343128ad><div class="tl" data-v-343128ad><span style="color:rgb(102 187 220);" data-v-343128ad>Token异常分析</span><div style="font-size:0.75rem;color:#6b7280;margin-top:0.5rem;font-weight:normal;" data-v-343128ad><i class="fas fa-sitemap" style="color:rgb(102 187 220);" data-v-343128ad></i> 对输入内容和目标输出的Token异常分析 </div></div></div>',1)),l("div",xs,[W.value?(i(),T(Vl,{key:0,ref_key:"curechart",ref:X,isnoDialog:!0,title:" ",data:W.value},null,8,["data"])):(i(),r("div",gs,t[95]||(t[95]=[l("i",{class:"fas fa-chart-bar"},null,-1),l("p",null,"Token异常分析将在这里显示",-1)])))])],512),[[H,y.value==4]]),t[97]||(t[97]=l("br",null,null,-1))])}}},Fs=xl(ys,[["__scopeId","data-v-343128ad"]]);export{Fs as default};
