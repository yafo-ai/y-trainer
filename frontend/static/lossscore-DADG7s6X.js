import{l as R}from"./lodash-CNPm4k7W.js";import{_ as W,c as G}from"./index-yrllAQxa.js";import{c as X}from"./changeModel-BqJeIFRh.js";import{r as n,p as c,t as e,S as u,U as a,Q as z,J as Y,O as m,ai as x,F,aa as L,q as i,T as d,M as $,I as A}from"./vue-CQnFr7Mm.js";import"./element-DYg7Q49L.js";import"./fselect-DH6-PXFJ.js";const Z={class:"page-index c-text-left"},ee={class:"module-header"},se={class:"model"},le={class:"c-cardtitlebox"},te={class:"titlebox nobg"},oe={class:"btnbox"},ne={key:0,style:{"min-height":"100px"},class:"contentbox"},ae={class:"compression-rounds",id:"compressionRounds"},ie={class:"compression-round","data-round":"1"},re={class:"round-header"},ue={class:"round-title"},de=["onClick"],pe={class:"params-grid"},ce={class:"param-group"},ve={class:"param-group"},me={class:"param-group"},_e={class:"param-group"},fe={style:{"margin-top":"10px"},class:"btnbox tr"},be={class:"c-gred c-rowbox"},ye={class:"c-cardtitlebox"},ge={class:"titlebox"},xe={class:"contentbox"},ke={class:"c-cardtitlebox"},he={class:"titlebox"},Ve={class:"contentbox"},we={class:"c-cardtitlebox c-rowbox"},Ce={style:{background:"rgb(248, 249, 250)",padding:"0",margin:"1.5rem",border:"1px solid #e5e7eb","border-radius":"0.5rem"},class:"contentbox"},Te={key:0,class:"lbox-content outputcontent"},Ue=["innerHTML"],Me={class:"scroetip"},Fe={key:1,class:"empty-state"},Le={class:"c-cardtitlebox c-rowbox"},$e={class:"contentbox"},Ie={class:"compression-round-result"},qe={class:"round-result-header"},ze={class:"round-result-title"},Ae={style:{display:"flex","align-items":"center",gap:"1rem"}},Be={class:"compression-stats"},Se={style:{"margin-bottom":"0.5rem","font-size":"0.75rem",color:"#6b7280"}},De=["innerHTML"],He={key:1,class:"empty-state"},Ne={__name:"lossscore",setup(Pe){const r=n({input:"",question:"",kernel_num:5,topk:150,min_scroe:0,score_type:1}),p=n(null),b=n([{kernel_num:5,topk:150,min_scroe:0,score_type:1}]),B=n(0),S=async()=>{if(r.value.input==="")return _this.$message("请输入数据");k.value=0,y.value=[],I(),console.log(y.value)},y=n([]),k=n(0),I=async v=>{r.value.model_name=M.value||void 0,k.value<b.value.length&&(r.value={...r.value,...b.value[k.value]});let s=R.cloneDeep(r.value);v&&(s.input=v);const t=await G(s);t&&t.data&&(p.value=t.data,p.value.compress_text_old=p.value.compress_text,p.value.compress_text=p.value.compress_text.replace(/\n/g,"<br />"),p.value.params=s,p.value.round=k.value,y.value.push(p.value),k.value++,k.value<b.value.length?I(p.value.compress_text_old):B.value=y.value.length-1),D()},C=n([]),T=n(1),q=n(0),D=(v,s)=>{P.value="";let t=p.value.attention_scores||[];T.value=Math.max(...t),q.value=Math.min(...t);let h=[];p.value.input_tokens.forEach((V,w)=>{let g="极低",f=t[w]/T.value*100;f>=80?g="极高":f>=60?g="高":f>=40?g="中等":f>=20&&(g="低"),h.push({text:V&&V.replace(/\n/g,"\\n"),value:t[w],maxVal:T.value,minVal:q.value,scorePercentage:f,attentionLevel:g,color:H(t[w],T.value)})}),C.value=h,console.log(C.value)},H=(v,s)=>`rgba(2, 169, 169,${v/s})`,N=()=>{r.value.input="",r.value.question=""},P=n(""),M=n("./big-models/"),E=n(!1),K=v=>{M.value=v.val,E.value=!1},U=n(!0),O=n(`人工智能（Artificial Intelligence，简称AI）是一门研究如何使计算机模拟人类智能的学科。它包括多个分支，如机器学习、深度学习、自然语言处理、计算机视觉等。

机器学习是AI的核心技术，它使计算机能够从数据中学习并提高性能，而无需明确编程。深度学习是机器学习的一个子集，它使用神经网络来模拟人脑的工作方式。

当前，AI技术已广泛应用于各个领域，如医疗诊断、金融分析、自动驾驶、智能客服等。尽管AI取得了显著进步，但它仍面临诸多挑战，如数据隐私、算法偏见、安全性等问题。

未来，随着技术的不断发展，AI有望在更多领域发挥重要作用，为人类社会带来更多便利和创新。`),j=n("人工智能"),J=v=>{window._this.$copy(v)};return(v,s)=>{const t=x("el-button"),h=x("el-input-number"),V=x("el-option"),w=x("el-select"),g=x("el-scrollbar"),f=x("el-input"),Q=x("el-popover");return i(),c("div",Z,[e("div",ee,[s[9]||(s[9]=e("h1",{class:"module-title"},[e("i",{class:"fas fa-compress"}),u(" 内容压缩 ")],-1)),e("div",se,[a(X,{val:M.value,onSubfn:K},null,8,["val"])])]),e("div",le,[e("div",te,[e("span",{onClick:s[0]||(s[0]=l=>U.value=!U.value),class:Y(["js-opentitle",{on:U.value}])},s[10]||(s[10]=[e("i",{class:"fas fa-cog"},null,-1),u(" 压缩参数配置"),e("i",{class:"fas fa-chevron-up"},null,-1)]),2),e("div",oe,[a(t,{onClick:N,tabindex:"-1",type:"info"},{default:m(()=>s[11]||(s[11]=[e("i",{class:"fas fa-redo"},null,-1),u(" 重置")])),_:1}),a(t,{onClick:S,tabindex:"-1",type:"success"},{default:m(()=>s[12]||(s[12]=[e("i",{class:"fas fa-play"},null,-1),u(" 开始压缩")])),_:1})])]),U.value?(i(),c("div",ne,[a(g,{"max-height":"300"},{default:m(()=>[e("div",ae,[(i(!0),c(F,null,L(b.value,(l,_)=>(i(),c("div",ie,[e("div",re,[e("div",ue,"第 "+d(_+1)+" 次压缩",1),b.value.length>1?(i(),c("button",{key:0,class:"remove-round-btn",onClick:o=>b.value.splice(_,1),style:{display:"block"}},s[13]||(s[13]=[e("i",{class:"fas fa-times"},null,-1),u(" 移除 ")]),8,de)):z("",!0)]),e("div",pe,[e("div",ce,[s[14]||(s[14]=e("label",{class:"param-label"},"卷积核大小",-1)),a(h,{onFocus:s[1]||(s[1]=o=>o.target.select()),style:{width:"100%"},modelValue:l.kernel_num,"onUpdate:modelValue":o=>l.kernel_num=o,placeholder:"请填写卷积核",min:0,"controls-position":"right"},null,8,["modelValue","onUpdate:modelValue"])]),e("div",ve,[s[15]||(s[15]=e("label",{class:"param-label"},"Top-K 值",-1)),a(h,{onFocus:s[2]||(s[2]=o=>o.target.select()),style:{width:"100%"},modelValue:l.topk,"onUpdate:modelValue":o=>l.topk=o,placeholder:"请填写topk",min:0,"controls-position":"right"},null,8,["modelValue","onUpdate:modelValue"])]),e("div",me,[s[16]||(s[16]=e("label",{class:"param-label"},"分数类型",-1)),a(w,{modelValue:l.score_type,"onUpdate:modelValue":o=>l.score_type=o,placeholder:"请选择分数类型",style:{width:"100%"}},{default:m(()=>[(i(),$(V,{key:1,label:"原始分数",value:1})),(i(),$(V,{key:2,label:"分数加权放大",value:2}))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),e("div",_e,[s[17]||(s[17]=e("label",{class:"param-label"},"最小分数阈值",-1)),a(h,{onFocus:s[3]||(s[3]=o=>o.target.select()),style:{width:"100%"},modelValue:l.min_scroe,"onUpdate:modelValue":o=>l.min_scroe=o,placeholder:"请填写min_score",min:0,"controls-position":"right"},null,8,["modelValue","onUpdate:modelValue"])])])]))),256))])]),_:1}),e("div",fe,[a(t,{onClick:s[4]||(s[4]=l=>b.value.push({kernel_num:5,topk:150,min_scroe:0,score_type:1})),type:"success",plain:""},{default:m(()=>s[18]||(s[18]=[e("i",{class:"fas fa-plus"},null,-1),u(" 添加压缩轮次")])),_:1})])])):z("",!0)]),e("div",be,[e("div",ye,[e("div",ge,[s[20]||(s[20]=e("span",null,[e("i",{class:"fas fa-edit"}),u(" 输入内容")],-1)),a(t,{onClick:s[5]||(s[5]=l=>r.value.input=O.value),size:"small",type:"info"},{default:m(()=>s[19]||(s[19]=[e("i",{class:"fas fa-file-import"},null,-1),u(" 示例")])),_:1})]),e("div",xe,[a(f,{modelValue:r.value.input,"onUpdate:modelValue":s[6]||(s[6]=l=>r.value.input=l),style:{width:"100%"},rows:14,type:"textarea",placeholder:`请输入需要压缩的文本内容...\r
\r
支持中文和英文文本，建议输入较长的文本以获得更好的压缩效果。`},null,8,["modelValue"])])]),e("div",ke,[e("div",he,[s[22]||(s[22]=e("span",null,[e("i",{class:"fas fa-question-circle"}),u(" 压缩指令")],-1)),a(t,{onClick:s[7]||(s[7]=l=>r.value.question=j.value),size:"small",type:"info"},{default:m(()=>s[21]||(s[21]=[e("i",{class:"fas fa-file-import"},null,-1),u(" 示例")])),_:1})]),e("div",Ve,[a(f,{modelValue:r.value.question,"onUpdate:modelValue":s[8]||(s[8]=l=>r.value.question=l),style:{width:"100%"},rows:14,type:"textarea",placeholder:`请输入压缩指令或问题...\r
\r
例如：请将上述内容压缩为100字以内的摘要，保留核心信息。`},null,8,["modelValue"])])])]),e("div",we,[s[24]||(s[24]=e("div",{class:"titlebox"},[e("span",null,[e("i",{class:"fas fa-chart-bar"}),u(" 原始内容Token分析")])],-1)),e("div",Ce,[C.value.length>0?(i(),c("div",Te,[(i(!0),c(F,null,L(C.value,(l,_)=>(i(),$(Q,{key:_,"show-after":500,placement:"top","popper-style":{width:"auto",padding:"10px",minWidth:"80px"},trigger:"hover"},{reference:m(()=>[e("span",{class:"item",style:A("background-color:"+l.color),innerHTML:l.text},null,12,Ue)]),default:m(()=>[e("div",Me,[u(" 原始分数: "+d(l.value.toFixed(4))+" ("+d(l.scorePercentage.toFixed(2))+"%) | 范围: "+d(l.minVal.toFixed(4))+" - "+d(l.maxVal.toFixed(4))+" | ",1),e("span",{style:A("background: "+l.color+";display: inline-block;border-radius: 20px;padding: 5px 10px;"),round:"",size:"mini"},d(l.attentionLevel),5)])]),_:2},1024))),128))])):(i(),c("div",Fe,s[23]||(s[23]=[e("i",{class:"fas fa-file-text"},null,-1),e("p",null,"原始内容的Token分析将在这里显示",-1),e("small",{style:{"margin-top":"0.5rem",display:"block"}},"输入内容后开始压缩查看分析结果",-1)])))])]),e("div",Le,[s[27]||(s[27]=e("div",{class:"titlebox"},[e("span",null,[e("i",{class:"fas fa-compress-alt"}),u(" 压缩结果")])],-1)),e("div",$e,[y.value.length>0?(i(!0),c(F,{key:0},L(y.value,(l,_)=>(i(),c("div",Ie,[e("div",qe,[e("div",ze,"第 "+d(_+1)+" 轮压缩结果",1),e("div",Ae,[e("div",Be,[e("span",null,"Token数: "+d(l.input_tokens.length),1),e("span",null,"移除: "+d(_>0?y.value[_-1].input_tokens.length-l.input_tokens.length:0),1)]),a(t,{onClick:o=>J(l.compress_text),type:"info",title:"复制第"+(_+1)+"轮结果",size:"small"},{default:m(()=>s[25]||(s[25]=[e("i",{class:"fas fa-copy"},null,-1)])),_:2},1032,["onClick","title"])])]),e("div",Se," 参数: 卷积核="+d(l.params.kernel_num)+", Top-K="+d(l.params.topk)+", 分数类型="+d(l.params.score_type==1?"原始分数":"分数加权放大")+", 最小分数="+d(l.params.min_scroe),1),e("div",{innerHTML:l.compress_text,class:"round-result-content"},null,8,De)]))),256)):(i(),c("div",He,s[26]||(s[26]=[e("i",{class:"fas fa-compress-alt"},null,-1),e("p",null,"压缩结果将在这里显示",-1),e("small",{style:{"margin-top":"0.5rem",display:"block"}},"配置参数后开始压缩",-1)])))])]),s[28]||(s[28]=e("br",null,null,-1))])}}},Re=W(Ne,[["__scopeId","data-v-2555515f"]]);export{Re as default};
