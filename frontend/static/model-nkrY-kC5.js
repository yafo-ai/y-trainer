import{F as b,l as ll}from"./fselect-D-sWLC6j.js";import{_ as al,f as el,i as sl,j as tl,k as ol,m as dl,n as rl,o as nl,s as ul}from"./index-CZdMHBuA.js";import{r as n,w as il,Y as pl,b as ml,p as C,t as a,U as o,S as d,O as r,ai as m,q as w,F as W,aa as E,M as N}from"./vue-CQnFr7Mm.js";import"./element-DYg7Q49L.js";const vl={class:"page-index c-text-left"},_l={class:"c-cardtitlebox c-rowbox"},bl={style:{"min-height":"60px"},class:"contentbox"},fl={class:"params-grid"},gl={class:"param-group"},yl={class:"param-group"},Vl={class:"param-group"},wl={class:"param-group"},cl={class:"tl"},kl={class:"param-group"},xl={class:"flexbox"},$l={class:"param-group"},Ul={class:"flexbox"},hl={class:"c-cardbox c-rowbox"},jl={class:"lbox"},Cl={class:"rbox"},Fl={class:"c-cardtitlebox c-rowbox"},ql={style:{"min-height":"60px"},class:"contentbox"},zl={class:"params-grid"},Sl={class:"param-group"},Tl={class:"param-label"},Ll={class:"param-group"},Bl={class:"param-group"},Dl={class:"param-group"},Rl={class:"c-cardtitlebox c-rowbox"},Wl={style:{"min-height":"60px"},class:"contentbox"},El={class:"params-grid"},Nl={class:"param-group"},Al={class:"param-group"},Ml={class:"flexbox"},Pl={class:"param-group"},Hl={class:"param-group"},Il={class:"param-group"},Jl={class:"param-group"},Ol={class:"param-label"},Yl={class:"c-cardtitlebox c-rowbox"},Gl={style:{"min-height":"60px"},class:"contentbox"},Kl={class:"params-grid"},Ql={class:"param-group"},Xl={class:"param-group"},Zl={class:"param-label"},la={class:"flexbox"},aa={class:"flexbox",style:{width:"calc(100% - 70px)"}},ea={class:"param-group"},sa={class:"param-group"},ta={class:"param-group"},oa={class:"param-group"},da={class:"param-group"},ra={class:"param-group"},na={class:"param-group"},ua={class:"param-group"},ia={class:"param-group"},pa={class:"param-group"},ma={class:"c-cardtitlebox c-rowbox"},va={class:"contentbox"},_a={class:"c-cardtitlebox c-rowbox"},ba={style:{"min-height":"60px"},class:"contentbox"},fa={class:"params-grid"},ga={class:"param-group"},ya={class:"param-group"},Va={class:"param-group"},wa={class:"param-group"},ca={class:"tl"},ka={style:{margin:"0 -18px"},class:"formbox"},xa={class:"dialog-footer"},$a={__name:"model",setup(Ua){const s=n({}),F=()=>{s.value={model_path_to_load:"./big-models/",data_type:"bfloat16",lora_path:"",lora_rank:16,lora_alpha:32,lora_dropout:.2,epoch:3,lr:"5e-6",lora_target_modules:"",checkpoint_epoch:[],batch_size:1,token_batch:10,pack_length:20520,max_seq_len:20520,system_prompt:"You are a helpful assistant.",data_path:"",output_dir:"",use_deepspeed:!1,gradit_checkpoing:!0,use_lora:!0,use_nlirg:!0,use_tensorboard:!!s.value.tensorboard_path,tensorboard_path:"",training_type:"sft"}};F(),n(null),n(""),n(""),n(!1);const A=async()=>{if(!M())return!1;let t=ll.cloneDeep(s.value);t.lora_target_modules=t.lora_target_modules.split(/,|，|\s+/);let l=await ul(t);l&&l.code===200&&_this.$message("训练开始成功","success")},M=()=>{if(!s.value.model_path_to_load)return window._this.$message("请选择要训练的模型","error"),!1;if(!s.value.lora_path&&s.value.use_lora&&(!s.value.lora_rank||!s.value.lora_alpha||!s.value.lora_dropout||!s.value.lora_target_modules))return window._this.$message("lora_rank,lora_alpha,lora_dropout,lora_target_modules不能为空","error"),!1;if(s.value.use_nlirg){if(!s.value.data_path)return window._this.$message("数据集路径不能为空","error"),!1;if(!s.value.epoch)return window._this.$message("训练轮数不能为空","error"),!1;if(!s.value.token_batch)return window._this.$message("token_batch不能为空","error"),!1;if(!s.value.batch_size)return window._this.$message("批次大小不能为空","error"),!1;if(!s.value.lr)return window._this.$message("学习率不能为空","error"),!1;if(!s.value.max_seq_len)return window._this.$message("序列最大长度不能为空","error"),!1;if(!s.value.pack_length)return window._this.$message(" (预训练)pack_length不能为空","error"),!1;if(!s.value.output_dir)return window._this.$message("模型保存路径不能为空","error"),!1}return!0};il(()=>s.value.lora_path,(t,l)=>{t!=l&&t?(s.value.lora_rank="",s.value.lora_dropout="",s.value.lora_alpha="",s.value.lora_target_modules=""):t!=l&&!t&&(s.value.lora_rank=16,s.value.lora_dropout=.2,s.value.lora_alpha=32,s.value.lora_target_modules="")});const P=()=>{F()},q=n([]);(async()=>{if(q.value.length<1){let t=await el();t&&t.data&&t.data.model_name&&t.data.model_name.length>0&&(q.value=t.data.model_name)}})(),pl(()=>{p&&p.close()}),ml(()=>{p&&p.close(),h()});const z=t=>{t&&window._this.$copy(t)},U=n("./data"),S=n([]);n([]);const T=async()=>{let t=await sl({data_dir:U.value});t.code==200&&t.data&&(S.value=t.data)};T();const H=async()=>{let t=await dl({lora_path:s.value.lora_path});t.code==200&&t.data&&(s.value.lora_rank=t.data.lora_rank,s.value.lora_alpha=t.data.lora_alpha,s.value.lora_dropout=t.data.lora_dropout,s.value.lora_target_modules=t.data.target_modules?t.data.target_modules.json(","):"")};let p;const y=n(0),h=()=>{const t=window.location.protocol==="https:"?"wss:":"ws:";let l=window.location.host;l=="192.168.50.65:5177"&&(l="192.168.50.109:8010");const f=`${t}//${l}/api/train/ws/terminal`;p&&(p=null),p=new WebSocket(f),p.onopen=()=>{c("WebSocket连接已建立，开始接收终端输出...","system")},p.onmessage=_=>{c(_.data,"output")},p.onclose=()=>{y.value=5,y.value>600&&(y.value=600),c("WebSocket连接已断开，"+y.value+"秒后尝试重连...","system"),setTimeout(h,y.value*1e3)},p.onerror=_=>{c("WebSocket连接错误","error")}};h();const c=(t,l="output")=>{const f=document.getElementById("terminal-output"),_=document.createElement("div");_.className=`terminal-line ${l}`,t=t.replace(/\u001b\[32m([^\u001b]+)\u001b\[0m/g,'<span style="color: #4ec9b0;">$1</span>'),t=t.replace(/\u001b\[31m([^\u001b]+)\u001b\[0m/g,'<span style="color: #f48771;">$1</span>'),t=t.replace(/\u001b\[34m([^\u001b]+)\u001b\[0m/g,'<span style="color: #569cd6;">$1</span>'),t=t.replace(/\u001b\[36m([^\u001b]+)\u001b\[0m/g,'<span style="color: #9cdcfe;">$1</span>'),t=t.replace(/\u001b\[90m([^\u001b]+)\u001b\[0m/g,'<span style="color: #858585;">$1</span>'),_.innerHTML=t,f.appendChild(_),I()},L=n(null);function I(){setTimeout(()=>{var t;(t=L.value)==null||t.setScrollTop(document.querySelector("#terminal-output").offsetHeight+40)},100)}const u=n({base_model_path:"./big-models/",lora_path:"./saved_models/",output_path:"./merged_models/name"}),v=n({data_path:"./data",model_path:"./big-models/",method:"",sort:!0}),V=n(""),J=async()=>{let t=await ol({output_path:V.value});t.code==200&&t.data&&D(t.data)},O=async()=>{if(!u.value.base_model_path||!u.value.output_path||!u.value.lora_path)return window._this.$message("请填写完整信息","error");let t=await nl(u.value);t.code==200&&t.data&&window._this.$message("模型合并成功","success")},Y=async()=>{let t=await tl(v.value);t.code==200&&t.data&&(V.value=t.data.output_path,window._this.$message("评估任务开启，请耐心等待。","success"))},G=async()=>{let t=await rl({data_path:s.value.data_path});t.code==200&&t.data&&D(t.data)},B=n({}),k=n(!1),D=t=>{k.value=!0,B.value=t},K=()=>{let t=[];for(let l=0;l<s.value.epoch;l++)t.push(l);return t};return n([]),n(!1),(t,l)=>{const f=m("el-option"),_=m("el-select"),i=m("el-button"),x=m("el-input"),j=m("el-radio"),Q=m("el-radio-group"),$=m("el-switch"),g=m("el-input-number"),R=m("el-scrollbar"),X=m("json-viewer"),Z=m("el-drawer");return w(),C("div",vl,[a("div",_l,[l[66]||(l[66]=a("div",{style:{"justify-content":"flex-start"},class:"titlebox"},[a("h1",{class:"module-title"},[a("i",{class:"fas fa-star-half-alt"}),d(" 训练语料评估 ")]),a("label",{class:"param-label"},"语料质量评估工具：分数越高学习困难度越大，需要排查语料中存在的问题。（非必要过程，但是建议先评估后训练）")],-1)),a("div",bl,[a("div",fl,[a("div",gl,[l[57]||(l[57]=a("label",{class:"param-label"},[a("span",{class:"c-danger"},"*"),d("模型路径 ")],-1)),o(b,{modelValue:v.value.model_path,"onUpdate:modelValue":l[0]||(l[0]=e=>v.value.model_path=e)},null,8,["modelValue"])]),a("div",yl,[l[58]||(l[58]=a("label",{class:"param-label"},[a("span",{class:"c-danger"},"*"),d("要评估语料路径：必须是包含文件名的完整路径 ")],-1)),o(b,{target_type:"file",modelValue:v.value.data_path,"onUpdate:modelValue":l[1]||(l[1]=e=>v.value.data_path=e)},null,8,["modelValue"])]),a("div",Vl,[l[59]||(l[59]=a("label",{class:"param-label"}," 选择算法 ",-1)),o(_,{style:{width:"100%"},modelValue:v.value.method,"onUpdate:modelValue":l[2]||(l[2]=e=>v.value.method=e),placeholder:"请选择"},{default:r(()=>[o(f,{key:"similarity_rank",label:"similarity_rank",value:"similarity_rank"}),o(f,{key:"filtered_rank",label:"filtered_rank",value:"filtered_rank"})]),_:1},8,["modelValue"])]),a("div",wl,[l[62]||(l[62]=a("label",{class:"param-label"},"   ",-1)),a("div",cl,[o(i,{onClick:l[3]||(l[3]=e=>{v.value.data_path="./data",v.value.model_path="./big-models/",v.value.method="",V.value=""}),type:"info"},{default:r(()=>l[60]||(l[60]=[a("i",{class:"fas fa-redo"},null,-1),d(" 重置")])),_:1}),o(i,{onClick:l[4]||(l[4]=e=>Y()),type:"success"},{default:r(()=>l[61]||(l[61]=[a("i",{class:"fas fa-play"},null,-1),d(" 开始评估")])),_:1})])]),a("div",kl,[l[63]||(l[63]=a("label",{class:"param-label"},"语料评估完成将保存的路径 ",-1)),a("div",xl,[o(x,{disabled:"",type:"text",placeholder:"",onFocus:l[5]||(l[5]=e=>e.target.select()),style:{width:"100%"},modelValue:V.value,"onUpdate:modelValue":l[6]||(l[6]=e=>V.value=e)},null,8,["modelValue"])])]),a("div",$l,[l[65]||(l[65]=a("label",{class:"param-label"},"   ",-1)),a("div",Ul,[o(i,{onClick:l[7]||(l[7]=e=>J()),type:"success"},{default:r(()=>l[64]||(l[64]=[d("查看结果")])),_:1})])])])])]),l[118]||(l[118]=a("div",{class:"module-header c-rowbox"},[a("h1",{class:"module-title"},[a("i",{class:"fas fa-band-aid"}),d(" 模型微调 ")])],-1)),a("div",hl,[a("div",jl,[o(i,{size:"large",onClick:l[8]||(l[8]=e=>s.value.training_type="sft"),type:s.value.training_type=="sft"?"primary":"info"},{default:r(()=>l[67]||(l[67]=[a("i",{class:"fas fa-chart-bar"},null,-1),d(" 指令微调（SFT）")])),_:1},8,["type"]),o(i,{size:"large",onClick:l[9]||(l[9]=e=>s.value.training_type="cpt"),type:s.value.training_type=="cpt"?"primary":"info"},{default:r(()=>l[68]||(l[68]=[a("i",{class:"fas fa-chart-line"},null,-1),d(" 预训练（CPT）")])),_:1},8,["type"])]),a("div",Cl,[o(i,{onClick:P,tabindex:"-1",type:"info"},{default:r(()=>l[69]||(l[69]=[a("i",{class:"fas fa-redo"},null,-1),d(" 重置")])),_:1}),o(i,{onClick:A,tabindex:"-1",type:"success"},{default:r(()=>l[70]||(l[70]=[a("i",{class:"fas fa-play"},null,-1),d(" 开始训练")])),_:1})])]),a("div",Fl,[l[79]||(l[79]=a("div",{class:"titlebox"},[a("span",null,[a("i",{class:"fas fa-sliders-h"}),d(" 模型配置 ")])],-1)),a("div",ql,[a("div",zl,[a("div",Sl,[a("label",Tl,[l[71]||(l[71]=a("span",{class:"c-danger"},"*",-1)),l[72]||(l[72]=d(" 要训练的模型：请将模型文件放入big-models目录下 ")),a("span",{onClick:l[10]||(l[10]=e=>z(s.value.model_path_to_load)),class:"c-primary-btn"},"复制")]),o(b,{modelValue:s.value.model_path_to_load,"onUpdate:modelValue":l[11]||(l[11]=e=>s.value.model_path_to_load=e)},null,8,["modelValue"])]),a("div",Ll,[l[76]||(l[76]=a("label",{class:"param-label"},"精度",-1)),o(Q,{modelValue:s.value.data_type,"onUpdate:modelValue":l[12]||(l[12]=e=>s.value.data_type=e)},{default:r(()=>[o(j,{value:"float16",size:"large"},{default:r(()=>l[73]||(l[73]=[d("float16")])),_:1}),o(j,{value:"float32",size:"large"},{default:r(()=>l[74]||(l[74]=[d("float32")])),_:1}),o(j,{value:"bfloat16",size:"large"},{default:r(()=>l[75]||(l[75]=[d("bfloat16")])),_:1})]),_:1},8,["modelValue"])]),a("div",Bl,[l[77]||(l[77]=a("label",{class:"param-label"},"是否启用梯度检查点",-1)),o($,{modelValue:s.value.gradit_checkpoing,"onUpdate:modelValue":l[13]||(l[13]=e=>s.value.gradit_checkpoing=e)},null,8,["modelValue"])]),a("div",Dl,[l[78]||(l[78]=a("label",{class:"param-label"},"deepSeed 多卡分布式训练",-1)),o($,{modelValue:s.value.use_deepspeed,"onUpdate:modelValue":l[14]||(l[14]=e=>s.value.use_deepspeed=e)},null,8,["modelValue"])])])])]),a("div",Rl,[l[91]||(l[91]=a("div",{class:"titlebox"},[a("span",null,[a("i",{class:"fas fa-sliders-h"}),d(" Lora配置 ")])],-1)),a("div",Wl,[a("div",El,[a("div",Nl,[l[80]||(l[80]=a("label",{class:"param-label"},"是否使用lora微调 ",-1)),o($,{modelValue:s.value.use_lora,"onUpdate:modelValue":l[15]||(l[15]=e=>s.value.use_lora=e)},null,8,["modelValue"])]),a("div",Al,[l[82]||(l[82]=a("label",{class:"param-label"},[d("要加载的lora路径 "),a("span",{title:"如果需要基于已训练lora继续训练，请在此处填写上一个lora的保存路径",class:"far fa-question-circle"})],-1)),a("div",Ml,[o(b,{style:{width:"calc(100% - 100px)"},modelValue:s.value.lora_path,"onUpdate:modelValue":l[16]||(l[16]=e=>s.value.lora_path=e)},null,8,["modelValue"]),o(i,{onClick:l[17]||(l[17]=e=>H()),type:"success"},{default:r(()=>l[81]||(l[81]=[d("加载参数")])),_:1})])]),l[89]||(l[89]=a("div",{class:"param-group"},null,-1)),l[90]||(l[90]=a("div",{class:"param-group"},null,-1)),a("div",Pl,[l[83]||(l[83]=a("label",{class:"param-label"},[a("span",{class:"c-danger"},"*"),d(" lora_rank "),a("span",{title:"rank 越高，LoRA适配器能够学习到的权重更新越复杂，可能带来更好的微调效果",class:"far fa-question-circle"})],-1)),o(g,{disabled:!!s.value.lora_path,controls:!1,onFocus:l[18]||(l[18]=e=>e.target.select()),style:{width:"100%"},modelValue:s.value.lora_rank,"onUpdate:modelValue":l[19]||(l[19]=e=>s.value.lora_rank=e),placeholder:""},null,8,["disabled","modelValue"])]),a("div",Hl,[l[84]||(l[84]=a("label",{class:"param-label"},[a("span",{class:"c-danger"},"*"),d(" lora_alpha "),a("span",{title:"适应强度：alpha 越大，LoRA适配器的贡献越大，模型更倾向于学习新任务的模式；alpha 越小，模型更依赖原始预训练权重。",class:"far fa-question-circle"})],-1)),o(g,{disabled:!!s.value.lora_path,controls:!1,onFocus:l[20]||(l[20]=e=>e.target.select()),style:{width:"100%"},modelValue:s.value.lora_alpha,"onUpdate:modelValue":l[21]||(l[21]=e=>s.value.lora_alpha=e),placeholder:""},null,8,["disabled","modelValue"])]),a("div",Il,[l[85]||(l[85]=a("label",{class:"param-label"},[a("span",{class:"c-danger"},"*"),d(" lora_dropout"),a("span",{title:"防止过拟合：较高的 dropout（如0.2-0.5）可以增强模型的泛化能力，尤其适用于数据量较小或任务复杂的场景。",class:"far fa-question-circle"})],-1)),o(g,{disabled:!!s.value.lora_path,controls:!1,onFocus:l[22]||(l[22]=e=>e.target.select()),style:{width:"100%"},modelValue:s.value.lora_dropout,"onUpdate:modelValue":l[23]||(l[23]=e=>s.value.lora_dropout=e),placeholder:""},null,8,["disabled","modelValue"])]),a("div",Jl,[a("label",Ol,[l[86]||(l[86]=a("span",{class:"c-danger"},"*",-1)),l[87]||(l[87]=d(" lora_target_modules")),l[88]||(l[88]=a("span",{title:"需要应用 LoRA 的目标模块列表",class:"far fa-question-circle"},null,-1)),a("span",{onClick:l[24]||(l[24]=e=>s.value.lora_target_modules="q_proj,k_proj,v_proj,o_proj,gate_proj,up_proj,down_proj"),class:"c-primary-btn"},"使用默认值")]),o(x,{disabled:!!s.value.lora_path,type:"text",placeholder:"用英文逗号分割（q_proj, v_proj, k_proj, o_proj, gate_proj, up_proj, down_proj）",controls:!1,onFocus:l[25]||(l[25]=e=>e.target.select()),style:{width:"100%"},modelValue:s.value.lora_target_modules,"onUpdate:modelValue":l[26]||(l[26]=e=>s.value.lora_target_modules=e)},null,8,["disabled","modelValue"])])])])]),a("div",Yl,[l[107]||(l[107]=a("div",{class:"titlebox"},[a("span",null,[a("i",{class:"fas fa-sliders-h"}),d(" 训练配置 ")])],-1)),a("div",Gl,[a("div",Kl,[a("div",Ql,[l[92]||(l[92]=a("label",{class:"param-label"},"开启nlirg算法(核心算法，默认启用) ",-1)),o($,{modelValue:s.value.use_nlirg,"onUpdate:modelValue":l[27]||(l[27]=e=>s.value.use_nlirg=e)},null,8,["modelValue"])]),a("div",Xl,[a("label",Zl,[l[93]||(l[93]=a("span",{class:"c-danger"},"*",-1)),l[94]||(l[94]=d(" 数据路径 ")),l[95]||(l[95]=a("span",{style:{"margin-left":"70px"}},"数据集",-1)),a("span",{onClick:l[28]||(l[28]=e=>z(s.value.data_path)),class:"c-primary-btn"},"复制")]),a("div",la,[a("div",aa,[o(b,{onBlur:l[29]||(l[29]=e=>T()),style:{width:"120px"},modelValue:U.value,"onUpdate:modelValue":l[30]||(l[30]=e=>U.value=e)},null,8,["modelValue"]),o(_,{multiple:"",filterable:"","collapse-tags":"","collapse-tags-tooltip":"","max-collapse-tags":2,style:{width:"calc(100% - 120px)"},modelValue:s.value.data_path,"onUpdate:modelValue":l[31]||(l[31]=e=>s.value.data_path=e),placeholder:"请选择"},{default:r(()=>[(w(!0),C(W,null,E(S.value,e=>(w(),N(f,{key:e.data_path,label:e.name,value:e.data_path},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),o(i,{onClick:l[32]||(l[32]=e=>G()),type:"success"},{default:r(()=>l[96]||(l[96]=[d("预览")])),_:1})])]),a("div",ea,[l[97]||(l[97]=a("label",{class:"param-label"},[a("span",{class:"c-danger"},"*"),d(" 训练轮数")],-1)),o(g,{"controls-position":"right",step:1,min:1,onFocus:l[33]||(l[33]=e=>e.target.select()),style:{width:"100%"},modelValue:s.value.epoch,"onUpdate:modelValue":l[34]||(l[34]=e=>s.value.epoch=e),placeholder:""},null,8,["modelValue"])]),a("div",sa,[l[98]||(l[98]=a("label",{class:"param-label"},[a("span",{class:"c-danger"},"*"),d(" token_batch(每批几个token)"),a("span",{title:"数量越大速度越快，但是效果越差，建议设置为10，最大不要超过20",class:"far fa-question-circle"})],-1)),o(g,{disabled:!s.value.use_nlirg,controls:!1,onFocus:l[35]||(l[35]=e=>e.target.select()),style:{width:"100%"},modelValue:s.value.token_batch,"onUpdate:modelValue":l[36]||(l[36]=e=>s.value.token_batch=e),placeholder:""},null,8,["disabled","modelValue"])]),a("div",ta,[l[99]||(l[99]=a("label",{class:"param-label"},[a("span",{class:"c-danger"},"*"),d(" 批次大小")],-1)),o(g,{disabled:s.value.use_nlirg,controls:!1,onFocus:l[37]||(l[37]=e=>e.target.select()),style:{width:"100%"},modelValue:s.value.batch_size,"onUpdate:modelValue":l[38]||(l[38]=e=>s.value.batch_size=e),placeholder:""},null,8,["disabled","modelValue"])]),a("div",oa,[l[100]||(l[100]=a("label",{class:"param-label"},[a("span",{class:"c-danger"},"*"),d(" 学习率")],-1)),o(x,{type:"text",onFocus:l[39]||(l[39]=e=>e.target.select()),style:{width:"100%"},modelValue:s.value.lr,"onUpdate:modelValue":l[40]||(l[40]=e=>s.value.lr=e),placeholder:""},null,8,["modelValue"])]),a("div",da,[l[101]||(l[101]=a("label",{class:"param-label"},[a("span",{class:"c-danger"},"*"),d(" 序列最大长度")],-1)),o(g,{controls:!1,onFocus:l[41]||(l[41]=e=>e.target.select()),style:{width:"100%"},modelValue:s.value.max_seq_len,"onUpdate:modelValue":l[42]||(l[42]=e=>s.value.max_seq_len=e),placeholder:""},null,8,["modelValue"])]),a("div",ra,[l[102]||(l[102]=a("label",{class:"param-label"},[a("span",{class:"c-danger"},"*"),d(" (预训练)pack_length")],-1)),o(g,{disabled:s.value.training_type=="sft",controls:!1,onFocus:l[43]||(l[43]=e=>e.target.select()),style:{width:"100%"},modelValue:s.value.pack_length,"onUpdate:modelValue":l[44]||(l[44]=e=>s.value.pack_length=e),placeholder:""},null,8,["disabled","modelValue"])]),a("div",na,[l[103]||(l[103]=a("label",{class:"param-label"},"需要保存的检查点（输入数字回车即可）",-1)),o(_,{disabled:s.value.use_deepspeed,style:{width:"100%"},modelValue:s.value.checkpoint_epoch,"onUpdate:modelValue":l[45]||(l[45]=e=>s.value.checkpoint_epoch=e),multiple:"",filterable:"","collapse-tags":"","collapse-tags-tooltip":"","max-collapse-tags":3,"allow-create":"","default-first-option":"",placeholder:"请选择"},{default:r(()=>[(w(!0),C(W,null,E(K(),e=>(w(),N(f,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["disabled","modelValue"])]),a("div",ua,[l[104]||(l[104]=a("label",{class:"param-label"},[a("span",{class:"c-danger"},"*"),d(" 训练权重文件的保存路径")],-1)),o(b,{style:{width:"100%"},modelValue:s.value.output_dir,"onUpdate:modelValue":l[46]||(l[46]=e=>s.value.output_dir=e)},null,8,["modelValue"])]),a("div",ia,[l[105]||(l[105]=a("label",{class:"param-label"},"TensorBoard日志保存路径 ",-1)),o(b,{style:{width:"100%"},modelValue:s.value.tensorboard_path,"onUpdate:modelValue":l[47]||(l[47]=e=>s.value.tensorboard_path=e)},null,8,["modelValue"])]),a("div",pa,[l[106]||(l[106]=a("label",{class:"param-label"},"默认系统提示词 ",-1)),o(x,{type:"text",disabled:s.value.training_type=="cpt",onFocus:l[48]||(l[48]=e=>e.target.select()),style:{width:"100%"},modelValue:s.value.system_prompt,"onUpdate:modelValue":l[49]||(l[49]=e=>s.value.system_prompt=e),placeholder:""},null,8,["disabled","modelValue"])])])])]),a("div",ma,[l[109]||(l[109]=a("div",{class:"titlebox"},[a("span",null,[a("i",{class:"fas fa-sliders-h"}),d(" 微调进度 ")])],-1)),a("div",va,[o(R,{ref_key:"scrollbarRef",ref:L,"max-height":"500"},{default:r(()=>l[108]||(l[108]=[a("div",{class:"terminal-body"},[a("div",{id:"terminal-output",class:"terminal-output"})],-1)])),_:1},512)])]),a("div",_a,[l[116]||(l[116]=a("div",{class:"titlebox"},[a("h1",{class:"module-title"},[a("i",{class:"fas fa-puzzle-piece"}),d(" Lora合并工具 ")])],-1)),a("div",ba,[a("div",fa,[a("div",ga,[l[110]||(l[110]=a("label",{class:"param-label"},[a("span",{class:"c-danger"},"*"),d(" 基座模型路径 ")],-1)),o(b,{style:{width:"100%"},modelValue:u.value.base_model_path,"onUpdate:modelValue":l[50]||(l[50]=e=>u.value.base_model_path=e)},null,8,["modelValue"])]),a("div",ya,[l[111]||(l[111]=a("label",{class:"param-label"},[a("span",{class:"c-danger"},"*"),d(" Lora路径 ")],-1)),o(b,{style:{width:"100%"},modelValue:u.value.lora_path,"onUpdate:modelValue":l[51]||(l[51]=e=>u.value.lora_path=e)},null,8,["modelValue"])]),a("div",Va,[l[112]||(l[112]=a("label",{class:"param-label"},[a("span",{class:"c-danger"},"*"),d(" 合并后的模型路径 ")],-1)),o(b,{style:{width:"100%"},modelValue:u.value.output_path,"onUpdate:modelValue":l[52]||(l[52]=e=>u.value.output_path=e)},null,8,["modelValue"])]),a("div",wa,[l[115]||(l[115]=a("label",{class:"param-label"},"   ",-1)),a("div",ca,[o(i,{onClick:l[53]||(l[53]=e=>{u.value.base_model_path="./big-models/",u.value.output_path="./merged_models/name",u.value.lora_path="./saved_models/"}),type:"info"},{default:r(()=>l[113]||(l[113]=[a("i",{class:"fas fa-redo"},null,-1),d(" 重置")])),_:1}),o(i,{onClick:l[54]||(l[54]=e=>O()),type:"success"},{default:r(()=>l[114]||(l[114]=[a("i",{class:"fas fa-play"},null,-1),d(" 开始合并")])),_:1})])])])])]),o(Z,{modelValue:k.value,"onUpdate:modelValue":l[56]||(l[56]=e=>k.value=e),title:"预览数据",size:"600px"},{default:r(()=>[a("div",ka,[o(R,null,{default:r(()=>[o(X,{"show-array-index":!0,sort:"","expand-depth":3,value:B.value},null,8,["value"])]),_:1})]),a("div",xa,[o(i,{type:"info",onClick:l[55]||(l[55]=e=>k.value=!1)},{default:r(()=>l[117]||(l[117]=[d(" 关闭 ")])),_:1})])]),_:1},8,["modelValue"]),l[119]||(l[119]=a("br",null,null,-1))])}}},za=al($a,[["__scopeId","data-v-dfdcd7cd"]]);export{za as default};
