import{_ as V,f as S,h as C,u as N,i as x,j as B}from"./index-DvaJYu1w.js";import{r as d,w as k,b as M,p as U,t as l,U as n,O as p,S as v,T as $,ai as F,aB as I,aC as R,q as T}from"./vue-CQnFr7Mm.js";import{F as _}from"./fselect-B0rI_y1k.js";const j={class:"modelselect"},q={style:{width:"34%"},class:"item"},D={style:{width:"34%"},class:"item"},E={style:{width:"30%"},class:"item"},O={__name:"changeModel",props:{id:{type:[String,Number],default:()=>0},title:{type:[String,Number],default:"切换模型"},val:{type:[String,Number],default:"./big-models"},modelValue:{type:Boolean,default:!1}},emits:["subfn","update:modelValue"],setup(f,{emit:g}){const m=f,b=g;I(),R(),N();const t=d(m.val||""),s=d(""),o=d(!1),r=d([]),y=async()=>{if(u(),r.value.length<1){let e=await S();e&&e.data&&e.data.model_name&&e.data.model_name.length>0&&(r.value=e.data.model_name)}};k(()=>m.val,async(e,a)=>{e!==a&&e&&(t.value=e)}),M(()=>{y()});const u=()=>{C().then(e=>{e&&e.data&&(e.data.model_name?(localStorage.setItem("cur_model",e.data.model_name),t.value=e.data.model_name,o.value=!0):o.value=!1,e.data.lora_path&&(s.value=e.data.lora_path),b("subfn",{val:t.value}))})},h=async()=>{if(!t.value)return _this.$message("请选择模型路径","warning"),!1;let e=await x({model_name:t.value,lora_path:s.value});e&&e.code===200&&(_this.$message("切换模型成功","success"),u())},w=async()=>{B().then(e=>{e&&e.code===200&&(_this.$message(e.data.message||"模型卸载完成","success"),u())})};return(e,a)=>{const c=F("el-button");return T(),U("div",j,[l("div",q,[a[2]||(a[2]=l("div",{class:"param-label"},"lora 文件的路径",-1)),n(_,{style:{width:"100%"},modelValue:s.value,"onUpdate:modelValue":a[0]||(a[0]=i=>s.value=i)},null,8,["modelValue"])]),l("div",D,[a[3]||(a[3]=l("div",{class:"param-label"},"模型路径",-1)),n(_,{style:{width:"100%"},modelValue:t.value,"onUpdate:modelValue":a[1]||(a[1]=i=>t.value=i)},null,8,["modelValue"])]),l("div",E,[a[5]||(a[5]=l("div",{class:"param-label"}," ",-1)),n(c,{onClick:h,class:"btn",type:"success"},{default:p(()=>[v($(o.value?"切换":"加载")+"模型",1)]),_:1}),n(c,{disabled:!o.value,onClick:w,class:"btn",type:"danger"},{default:p(()=>a[4]||(a[4]=[v("卸载模型")])),_:1},8,["disabled"])])])}}},H=V(O,[["__scopeId","data-v-13cbfd27"]]);export{H as c};
